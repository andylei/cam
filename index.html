<html>
  <head>
    <style>
     .bar {
       fill: steelblue;
     }

     .bar:hover {
       fill: brown;
     }

     .grid.x path, .grid.x text {
       display: none;
     }
     .grid.x line {
       stroke: #ebebeb;
       stroke-dasharray: 5, 5;
     }
    </style>
  </head>
  <body>
    <h1>hi</h1>
    <svg width="960" height="500"></svg>
    <script src="bower_components/d3/d3.js"></script>
    <script>
      function prop(name) {
        return (obj) => obj[name];
      }

      let barHeight = 20;
      var svg = d3.select("svg"),
          margin = {top: 20, right: 20, bottom: 30, left: 40},
          width = +svg.attr("width") - margin.left - margin.right;

      let container = svg.append("g")
                         .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

      let NUMERIC_PROPS = ['weight', 'strength', 'lower', 'upper', 'range',
                           'usable_lower', 'usable_upper'];
      d3.tsv("data.tsv", function(d) {
        for (let prop of NUMERIC_PROPS) {
          d[prop] = +d[prop];
        }
        return d;
      }, function(error, data) {
        if (error) throw error;
        //data.sort((d0, d1) => d1.lower - d0.lower);

        let numRows = data.length;
        let height = barHeight * numRows;
        let frameHeight = height + margin.top + margin.bottom;
        svg.attr('height', frameHeight + 'px');

        let y = d3.scaleBand().rangeRound([0, height]).padding(0.1),
            x = d3.scaleLinear().rangeRound([0, width]);

        x.domain([d3.min(data, prop('lower')), d3.max(data, prop('upper')) ]);
        y.domain(d3.range(numRows));

        container.append("g")
                 .attr("class", "axis axis--x")
                 .attr("transform", "translate(0," + height + ")")
                 .call(d3.axisBottom(x).ticks(20));

        container.append("g")
                 .attr('class', 'grid x')
                 .call(d3.axisBottom(x).ticks(20).tickSize(height).tickFormat(''));

        let bars = container.selectAll(".bar")
                            .data(data)
                            .enter()
                            .append("g")
                            .attr('class', 'bar');

        let barRects = bars.append('rect')
                           .attr("x", (d) => x(d.lower))
                           .attr("y", (d, i) => y(i))
                           .attr("width", (d) => x(d.upper) - x(d.lower))
                           .attr("height", y.bandwidth());

        let labels = bars.append('text')
                         .attr('x', (d) => x(d.upper) + 5)
                         .attr('y', (d, i) => y(i) + barHeight)
                         .attr('dy', '-.35em')
                         .text((d) => `${d.brand} ${d.model} ${d.size}`);
      });
    </script>
  </body>
</html>
